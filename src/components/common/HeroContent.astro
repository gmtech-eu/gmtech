---
import heroData from '@data/hero.json';
import Button from '@ui/Button.astro';
import { getImage } from 'astro:assets';

const { title, subtitle, primaryCTA, secondaryCTA, image } = heroData;

const images = import.meta.glob('/src/assets/**/*.{png,jpg,jpeg,gif,webp,avif}', {
  eager: true,
  import: 'default',
});

function resolveImage(imagePath: string): ImageMetadata | null {
  if (!imagePath) return null;

  const fullPath = imagePath.replace('@assets', '/src/assets');
  return (images[fullPath] as ImageMetadata) ?? null;
}

const keystaticImage = resolveImage(image?.src);
const heroImageUrl = keystaticImage ? (await getImage({ src: keystaticImage, format: 'webp' })).src : null;
---

{/* Hero Content */}
<div class="flex flex-col items-center gap-8 lg:flex-row lg:gap-12">
  {/* Left side - Content */}
  <div class="flex-1 space-y-6">
    <div class="text-left">
      <h1 class="block text-3xl text-balance text-slate-800 sm:text-4xl md:text-5xl lg:text-6xl">
        {title}
      </h1>
    </div>

    <div class="text-left">
      <p class="text-lg text-pretty text-slate-700">
        {subtitle}
      </p>
    </div>

    {/* CTA Buttons */}
    <div class="flex flex-col justify-start gap-5 sm:flex-row">
      <Button href={secondaryCTA.href} variant="secondary">{secondaryCTA.text}</Button>
      <Button href={primaryCTA.href} variant="primary">{primaryCTA.text}</Button>
    </div>
  </div>

  {/* Right side - Image */}
  <div class="flex flex-1 justify-center lg:justify-end">
    <img src={heroImageUrl} alt={image?.alt || 'GMTEC Group'} width="1000" height="1000" class="rounded-3xl" />
  </div>
</div>
